<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Management | Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        :root {
            --bg-color: #fcfcfc;
            --sidebar-color: #09090b;
            --primary-accent: #18181b;
            --border-color: #e4e4e7;
            --text-main: #09090b;
            --text-muted: #71717a;
            --zinc-50: #fafafa;
            --zinc-100: #f4f4f5;
            --zinc-200: #e4e4e7;
            --zinc-300: #d4d4d8;
            --zinc-800: #27272a;
            --zinc-900: #18181b;
            --zinc-950: #09090b;
        }
        body { background-color: var(--bg-color); font-family: 'Inter', sans-serif; color: var(--text-main); }
        .font-serif { font-family: 'Playfair Display', serif; }
        
        .sidebar { height: 100vh; background-color: var(--sidebar-color); color: white; padding-top: 2rem; position: fixed; width: 260px; overflow-y: auto; border-right: 1px solid var(--zinc-800); }
        .sidebar .brand { font-family: 'Playfair Display', serif; font-size: 1.5rem; letter-spacing: 0.1em; padding: 0 1.5rem 2rem; border-bottom: 1px solid var(--zinc-800); margin-bottom: 1.5rem; }
        .sidebar a { color: #a1a1aa; text-decoration: none; padding: 0.65rem 1.5rem; display: flex; align-items: center; font-size: 0.85rem; transition: all 0.2s ease; border-left: 3px solid transparent; }
        .sidebar a:hover { color: white; background-color: var(--zinc-900); }
        .sidebar a.active { color: white; background-color: var(--zinc-900); border-left-color: white; font-weight: 500; }
        
        .sidebar .nav-section { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.2em; color: #52525b; padding: 1.5rem 1.5rem 0.5rem; font-weight: 600; }
        
        .main-content { margin-left: 260px; padding: 3rem 4rem; }
        
        .card { border: 1px solid var(--zinc-200); border-radius: 0; box-shadow: none; background: white; }
        .card-header { background: var(--zinc-50); border-bottom: 1px solid var(--zinc-200); padding: 1rem 1.5rem; }
        
        .btn { border-radius: 0; font-size: 0.85rem; padding: 0.5rem 1.25rem; font-weight: 500; transition: all 0.2s; }
        .btn-primary { background-color: var(--zinc-900); border: 1px solid var(--zinc-900); color: white; }
        .btn-primary:hover { background-color: var(--zinc-950); border-color: var(--zinc-950); }
        .btn-outline-dark { border-color: var(--zinc-300); color: var(--zinc-900); }
        .btn-outline-dark:hover { background-color: var(--zinc-900); color: white; border-color: var(--zinc-900); }
        
        table { border: 1px solid var(--zinc-200); }
        .table thead th { background-color: var(--zinc-50); color: var(--zinc-950); font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; font-weight: 600; padding: 1rem; border-bottom: 1px solid var(--zinc-200); }
        .table tbody td { padding: 1rem; border-bottom: 1px solid var(--zinc-100); font-size: 0.875rem; }
        
        .status-badge { font-size: 0.65rem; text-transform: uppercase; font-weight: 700; padding: 0.35rem 0.65rem; border-radius: 0; letter-spacing: 0.05em; }
        
        .search-bar .form-control { border-radius: 0; border: 1px solid var(--zinc-200); padding: 0.5rem 1rem; font-size: 0.85rem; }
        .search-bar .form-control:focus { box-shadow: none; border-color: var(--zinc-950); }
        
        .pagination .page-link { border-radius: 0; color: var(--zinc-900); border-color: var(--zinc-200); padding: 0.5rem 0.85rem; }
        .pagination .page-item.active .page-link { background-color: var(--zinc-900); border-color: var(--zinc-900); color: white; }
        
        /* Custom UI additions */
        .page-header { border-bottom: 1px solid var(--zinc-200); margin-bottom: 2.5rem; padding-bottom: 1.5rem; }
        .metric-card { transition: transform 0.2s ease; }
        .metric-card:hover { transform: translateY(-2px); }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="brand">ELYSIAN</div>
        <% if (locals.user) { %>
            <div class="px-4 mb-4">
                <div class="small text-muted mb-1 uppercase tracking-widest" style="font-size: 0.6rem;">Authenticated As</div>
                <div class="fw-bold" style="font-size: 0.9rem;"><%= user.name %></div>
                <div class="text-muted" style="font-size: 0.75rem;"><%= user.role.toUpperCase() %></div>
            </div>
        <% } %>
        
        <div class="nav-section">Operations</div>
        <a href="/" class="<%= (locals.page === 'overview') ? 'active' : '' %>">Overview</a>
        <a href="/bookings" class="<%= (locals.page === 'walk-in') ? 'active' : '' %>">Bookings</a>
        <a href="/requests" class="<%= (locals.page === 'requests') ? 'active' : '' %>">Online Requests</a>
        <a href="/housekeeping" class="<%= (locals.page === 'housekeeping') ? 'active' : '' %>">Housekeeping</a>
        <a href="/guests" class="<%= (locals.page === 'guests') ? 'active' : '' %>">Guests (CRM)</a>
        
        <div class="nav-section">Inventory</div>
        <a href="/room-types" class="<%= (locals.page === 'room-types') ? 'active' : '' %>">Room Types</a>
        <a href="/rooms" class="<%= (locals.page === 'rooms') ? 'active' : '' %>">Rooms</a>
        
        <div class="nav-section">Services</div>
        <a href="/pos" class="<%= (locals.page === 'pos') ? 'active' : '' %>">Point of Sale (POS)</a>
        <a href="/restaurant-admin" class="<%= (locals.page === 'restaurant') ? 'active' : '' %>">Restaurant Menu</a>
        <a href="/payments" class="<%= (locals.page === 'payments') ? 'active' : '' %>">Payments</a>
        
        <div class="nav-section">Intelligence</div>
        <a href="/reports" class="<%= (locals.page === 'reports') ? 'active' : '' %>">Reports & Analytics</a>
        
        <% if (locals.user && user.role === 'admin') { %>
            <div class="nav-section">Administration</div>
            <a href="/staff" class="<%= (locals.page === 'staff') ? 'active' : '' %>">Staff Management</a>
            <a href="/audit" class="<%= (locals.page === 'audit') ? 'active' : '' %>">Audit Trail</a>
        <% } %>
        
        <div class="nav-section mt-4">System</div>
        <a href="/reports/excel" class="text-info">Export Data (XLSX)</a>
        <a href="/logout" class="text-danger">Logout</a>
    </div>
    <div class="main-content">
        <!-- Toast Container -->
        <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1100;">
            <div id="bookingToast" class="toast border-0 shadow-lg" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="toast-header bg-dark text-white border-0">
                    <strong class="me-auto">New Online Request</strong>
                    <small>Just now</small>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast"></button>
                </div>
                <div class="toast-body bg-white p-3">
                    <p class="mb-2 small"><strong id="toastGuest"></strong> has requested a <span id="toastRoom"></span>.</p>
                    <div class="d-flex justify-content-between align-items-center">
                        <span class="fw-bold text-success" id="toastTotal"></span>
                        <a href="/requests" class="btn btn-xs btn-dark py-1 px-2 small" style="font-size: 0.7rem;">VIEW REQUESTS</a>
                    </div>
                </div>
            </div>
        </div>

        <% if (locals.error) { %>
            <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
                <%= error %>
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        <% } %>
