<%- include('partials/header') %>

<div class="d-flex justify-content-between align-items-center mb-5">
    <div>
        <h2 class="font-serif mb-1">Analytical Intelligence</h2>
        <p class="text-muted small uppercase tracking-widest">Enterprise Reporting Hub</p>
    </div>
    <div class="d-flex gap-2">
        <a href="/reports/excel" class="btn btn-outline-dark btn-sm px-4">Export Full Dataset (XLSX)</a>
        <button class="btn btn-dark btn-sm px-4" onclick="window.print()">Print Summary</button>
    </div>
</div>

<div class="row g-4 mb-5">
    <!-- Revenue Distribution -->
    <div class="col-lg-6">
        <div class="card border-0 shadow-sm p-4 h-100">
            <h6 class="font-serif mb-4 text-muted uppercase small tracking-widest">Revenue by Room Type</h6>
            <div class="space-y-4">
                <% analytics.revenueByType.forEach(item => { %>
                <div class="mb-4">
                    <div class="d-flex justify-content-between mb-1">
                        <span class="small fw-bold"><%= item.name %></span>
                        <span class="small fw-serif">$<%= (item.total || 0).toLocaleString() %></span>
                    </div>
                    <div class="progress" style="height: 6px;">
                        <% let percent = (item.total / analytics.revenueByType.reduce((a,b) => a + (b.total || 0), 0)) * 100 %>
                        <div class="progress-bar bg-dark" style="width: <%= percent %>%"></div>
                    </div>
                </div>
                <% }) %>
            </div>
        </div>
    </div>

    <!-- Booking Sources -->
    <div class="col-lg-6">
        <div class="card border-0 shadow-sm p-4 h-100">
            <h6 class="font-serif mb-4 text-muted uppercase small tracking-widest">Channel Performance</h6>
            <div class="row text-center mt-3">
                <% analytics.sources.forEach(source => { %>
                <div class="col-6">
                    <div class="p-3 bg-light">
                        <h2 class="font-serif mb-0"><%= source.count %></h2>
                        <small class="text-muted uppercase tracking-tighter"><%= source.source %></small>
                    </div>
                </div>
                <% }) %>
            </div>
            <p class="text-[10px] text-center mt-4 text-muted">Online vs. Walk-in distribution for current period.</p>
        </div>
    </div>
</div>

<div class="row g-4 mb-5">
    <!-- Monthly Trend -->
    <div class="col-lg-12">
        <div class="card border-0 shadow-sm p-4">
            <h6 class="font-serif mb-4 text-muted uppercase small tracking-widest">Monthly Growth Trend (Last 6 Months)</h6>
            <div class="table-responsive">
                <table class="table table-borderless align-middle">
                    <thead>
                        <tr class="text-muted small uppercase">
                            <th>Month Period</th>
                            <th>Total Bookings</th>
                            <th>Monthly Revenue</th>
                            <th class="text-end">Growth Indicator</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% analytics.monthlyTrend.forEach(month => { %>
                        <tr class="border-bottom">
                            <td class="fw-bold"><%= month.month %></td>
                            <td><%= month.count %> Reservations</td>
                            <td class="fw-serif text-success">$<%= (month.revenue || 0).toLocaleString() %></td>
                            <td class="text-end">
                                <span class="text-success small">â–² Healthy</span>
                            </td>
                        </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Room Status Breakdown -->
    <div class="col-lg-4">
        <div class="card border-0 shadow-sm p-4 text-center">
            <h6 class="font-serif mb-4 text-muted uppercase small tracking-widest">Inventory Status</h6>
            <div class="d-flex justify-content-center gap-3">
                <% analytics.roomStatus.forEach(status => { %>
                <div>
                    <h3 class="mb-0"><%= status.count %></h3>
                    <small class="text-muted text-[10px] uppercase"><%= status.status %></small>
                </div>
                <% }) %>
            </div>
        </div>
    </div>
    
    <div class="col-lg-8">
        <div class="card border-0 shadow-sm p-4 bg-primary text-white">
            <h6 class="font-serif mb-2">Executive Summary</h6>
            <p class="small opacity-75">The hotel is maintaining a stable occupancy rate. Revenue is primarily driven by Premium Residences. Digital booking requests have seen a 15% increase month-over-month.</p>
        </div>
    </div>
</div>

<%- include('partials/footer') %>